<% content_for :breadcrumbs do %>
  <%= breadcrumb 'Home', root_path(shopify_path_params) %>
  <%= breadcrumb_separator %>
  <%= breadcrumb 'Campaigns', campaigns_path(shopify_path_params) %>
  <%= breadcrumb_separator %>
  <%= breadcrumb @campaign.name, campaign_path(@campaign, shopify_path_params) %>
  <%= breadcrumb_separator %>
  <%= breadcrumb 'Edit' %>
<% end %>

<div class="container mx-auto px-4 py-8">
  <div class="max-w-2xl mx-auto">
    <h1 class="text-3xl font-bold mb-6">Edit Campaign</h1>

    <div class="bg-white rounded-lg shadow p-6">
      <%= form_with model: @campaign, local: true, data: { turbo: false }, html: { class: "space-y-4" } do |f| %>
        <%= hidden_field_tag :shop, params[:shop] if params[:shop].present? %>
        <%= hidden_field_tag :host, params[:host] if params[:host].present? %>
        <%= hidden_field_tag :embedded, params[:embedded] if params[:embedded].present? %>
        <%= hidden_field_tag :id_token, params[:id_token] if params[:id_token].present? %>

        <% if @campaign.errors.any? %>
          <div class="bg-red-50 border border-red-200 rounded p-4">
            <h3 class="text-red-800 font-semibold mb-2"><%= pluralize(@campaign.errors.count, "error") %> prevented this campaign from being saved:</h3>
            <ul class="list-disc list-inside text-red-700">
              <% @campaign.errors.full_messages.each do |message| %>
                <li><%= message %></li>
              <% end %>
            </ul>
          </div>
        <% end %>

        <div>
          <%= f.label :name, "Campaign Name", class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= f.text_field :name,
              class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",
              required: true %>
          <p class="text-sm text-gray-500 mt-1">Give your campaign a unique, descriptive name</p>
        </div>

        <div>
          <%= f.label :description, "Description (Optional)", class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= f.text_area :description,
              class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",
              rows: 4 %>
          <p class="text-sm text-gray-500 mt-1">Provide additional context about this campaign for your records</p>
        </div>

        <div class="flex justify-end space-x-3 pt-4">
          <%= link_to "Cancel", campaign_path(@campaign, shopify_path_params), class: "px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded" %>
          <%= f.submit "Update Campaign", class: "px-4 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded cursor-pointer" %>
        </div>
      <% end %>
    </div>
  </div>
</div>
